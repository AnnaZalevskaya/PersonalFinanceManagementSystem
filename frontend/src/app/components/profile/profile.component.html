<main>
  <div class="container" *ngIf="isLoadingForm">
    <h1>Profile</h1>
    <div class="profile-header">
      <button mat-button class="add-account-button" color="accent" routerLink="/profile/{{ user.id }}/add-account">Create an account</button>
    </div>
    <mat-grid-list cols="2" rowHeight="2:1">
      <mat-grid-tile>
        <div class="profile-container">
          <mat-card class="profile-info">
            <mat-card-header class="account-card-header">
              <p class="username">{{ user.username }}</p>
            </mat-card-header>
            <mat-divider></mat-divider>
            <mat-card-content>
              <p>Email: {{ user.email }}</p>
              <p>Phone: {{ user.phoneNumber }}</p>
            </mat-card-content>
          </mat-card>
        </div>
      </mat-grid-tile>
      <mat-grid-tile>
        <div class="accounts-container">
          <h2>User accounts</h2>
          <div id="account-cards-container">
            <ng-container *ngIf="accounts.length > 0; else noAccountsMessage">
              <mat-card *ngFor="let account of accounts" class="account-card" [ngClass]="{'negative-balance': account.balance < 0}">
                <mat-card-header class="account-card-header">
                  <h3>
                    <a routerLink="/profile/{{ user.id }}/account/{{ account.id }}" routerLinkActive="active-link">
                      {{ account.name }}
                    </a>
                  </h3>
                </mat-card-header>
                <mat-card-content class="account-card-body">
                  <p>ID: {{ account.id }}</p>
                  <p>Balance: {{ account.balance }}</p>
                  <p>Currency: {{ account.currency.name }} ({{ account.currency.abbreviation }})</p>
                  <p>Account Type: {{ account.accountType.name }}</p>
                </mat-card-content>
              </mat-card>
              <div class="pagination">
                <button (click)="goToPreviousPage()" [disabled]="paginationSettings.pageNumber === 1">Previous</button>
                <span>Page {{ paginationSettings.pageNumber }}</span>
                <button (click)="goToNextPage()" [disabled]="this.accounts.length < 5">Next</button>
              </div>
            </ng-container>
            <ng-template #noAccountsMessage>
              <div class="message">
                This user has not created accounts yet
              </div>
            </ng-template>
          </div>
        </div>
      </mat-grid-tile>
    </mat-grid-list>

  </div>
  <app-loading-indicator *ngIf="!isLoadingForm"></app-loading-indicator>
</main>